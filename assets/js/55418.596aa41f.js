"use strict";(self.webpackChunkvp=self.webpackChunkvp||[]).push([[55418],{55418:(e,l,o)=>{o.r(l),o.d(l,{default:()=>M});var t=o(66252),s=o(49963);const n={class:"supported-devices"},i={class:"filters"},r={key:"no-results"};var a=o(99017),d=o(55377),c=o(90924),u=o(2262),v=o(3577);const p={class:"device"},m={class:"thumb"},h={class:"top-right"},f={key:0},w={key:0,class:"is-new"},y=(0,t.Uk)("new"),k={class:"desc"},b={class:"model"};var g=o(18820),P=o(98038);const V={name:"Device",components:{QTooltip:g.Z,QIcon:P.Z},props:["device"],emits:["vendor-click"],setup(e){const l=(0,u.iH)(e.device.link.substr(2)),o=(0,u.iH)(!1);return(0,t.YP)(e.device,(e=>{o.value=new Date(e.addedAt)>Date.now()-2592e6,l.value=e.link.substr(2)}),{immediate:!0}),{isNew:o,link:l}}};var I=o(83744);const _=(0,I.Z)(V,[["render",function(e,l,o,s,n,i){const r=(0,t.up)("router-link"),a=(0,t.up)("q-tooltip"),d=(0,t.up)("q-icon");return(0,t.wg)(),(0,t.iD)("div",p,[(0,t.Wm)(r,{class:"title",to:s.link},{default:(0,t.w5)((()=>[(0,t.Uk)((0,v.zw)(o.device.description),1)])),_:1},8,["to"]),(0,t._)("div",m,[(0,t._)("div",h,[(0,t._)("div",null,[(0,t._)("div",{class:"vendor",onClick:l[0]||(l[0]=l=>e.$emit("vendor-click",o.device.vendor))},[(0,t.Uk)((0,v.zw)(o.device.vendor),1),(0,t.Wm)(a,{self:"center end"},{default:(0,t.w5)((()=>[o.device.isWhiteLabel?((0,t.wg)(),(0,t.iD)("span",f,"White-Label Device -")):(0,t.kq)("",!0),(0,t.Uk)(" Filter by "+(0,v.zw)(o.device.vendor),1)])),_:1}),o.device.isWhiteLabel?((0,t.wg)(),(0,t.j4)(d,{key:0,name:"more"})):(0,t.kq)("",!0)])])]),s.isNew?((0,t.wg)(),(0,t.iD)("div",w,[y,(0,t.Wm)(a,{self:"center start"},{default:(0,t.w5)((()=>[(0,t.Uk)("Added at "+(0,v.zw)(new Date(o.device.addedAt).toLocaleString()),1)])),_:1})])):(0,t.kq)("",!0),(0,t.Wm)(r,{class:"device-img",to:s.link,style:(0,v.j5)({backgroundImage:"url("+o.device.image+")"})},null,8,["to","style"])]),(0,t._)("div",k,[(0,t._)("div",b,(0,v.zw)(o.device.model),1),(0,t.Uk)("- "+(0,v.zw)(o.device.exposes.join(", ")),1)])])}]]),H={class:"device-filters"},S={class:"vendor-filter"},U={class:"exposes-filter"},x={class:"search-filter"},F=(0,t.Uk)("RegEx support. E.g you can use"),Z=(0,t._)("code",null," (wall|switch)",-1),q=(0,t.Uk)(" to search for wall OR switch.");var C=o(30637);const E=(0,t.Uk)("No results");var W=o(69696),D=o(91697),T=o(87761);const Y=(0,t.aZ)({name:"multi-select",components:{QSelect:T.Z,QItem:W.Z,QItemSection:D.Z},props:["label","options"],inheritAttrs:!0,setup(e,{emit:l,attrs:o}){const s=(0,u.iH)(null),n=(0,u.iH)(e.options);return((0,u.dq)(e.options)||(0,u.PG)(e.options))&&(0,t.YP)(e.options,(e=>{l("update:modelValue",o.modelValue.value.filter((l=>e.includes(l))))})),{el:s,hidePopup:()=>{s.value.hidePopup()},clearSearch(e){setTimeout((()=>{e.$el.querySelector("input").value=""}),10)},filteredOptions:n,filterFn(l,o){o((()=>{const o=l.toLowerCase();n.value=e.options.filter((e=>e.toLowerCase().includes(o)))}))}}}}),L=(0,I.Z)(Y,[["render",function(e,l,o,s,n,i){const r=(0,t.up)("q-item-section"),a=(0,t.up)("q-item"),d=(0,t.up)("q-select");return(0,t.wg)(),(0,t.j4)(d,{label:e.label,filled:"",clearable:"","use-chips":"","use-input":"","input-debounce":"0",options:e.filteredOptions,onFilter:e.filterFn,multiple:"","options-dense":"",onPopupHide:l[0]||(l[0]=l=>e.clearSearch(this)),ref:"el","onUpdate:modelValue":e.hidePopup},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(a,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-grey"},{default:(0,t.w5)((()=>[E])),_:1})])),_:1})])),_:1},8,["label","options","onFilter","onUpdate:modelValue"])}]]),j=window.ZIGBEE2MQTT_SUPPORTED_DEVICES,A=new Set,Q=new Set;j.forEach((({exposes:e,vendor:l})=>{Q.add(l),e.forEach((e=>A.add(e)))}));const R=(e,l)=>e.localeCompare(l,void 0,{sensitivity:"base"}),z=j,N=Array.from(Q).sort(R),O=Array.from(A).sort(R),K={arrayKeys:[],parseHash(){const e=location.hash.substr(1).split("&").map((e=>e.split("="))).map((([e,l])=>this.arrayKeys.includes(e)?[e,l.split(",").map((e=>decodeURIComponent(e)))]:[e,decodeURIComponent(l)])).filter((([e,l])=>e.length>0&&l.length>0));return Object.fromEntries(e)},updateHash(e){const l=this.parseHash();Object.entries(e).forEach((([e,o])=>{l[e]=o}));let o="#";Object.entries(l).forEach((([e,l])=>{if(null!=l&&""!==l)if(this.arrayKeys.includes(e)){const t=l.map((e=>encodeURIComponent(e))).join(",");o+=`${e}=${t}&`}else o+=`${e}=${encodeURIComponent(l)}&`})),location.hash=o.substr(0,o.length-1)}};K.arrayKeys.push("v"),K.arrayKeys.push("e");const $=(0,t.aZ)({name:"filters",components:{QInput:C.Z,QTooltip:g.Z,QIcon:P.Z,MultiSelect:L},props:["modelValue"],setup(e,{emit:l}){const o=K.parseHash(),s=(0,u.iH)(o.e||null),n=(0,u.iH)(o.v||null),i=(0,u.iH)(o.s||null),r=e=>()=>{Array.isArray(e.value)&&0===e.value.length&&(e.value=null)};(0,t.YP)((()=>e.modelValue),(e=>{if(!e)return;const{exposes:l,vendors:o,search:t}=e;l&&(s.value=l),o&&(n.value=o),t&&(i.value=t)}));const a=()=>{K.updateHash({e:s.value,v:n.value,s:i.value}),s.value||n.value||i.value?l("update:modelValue",{exposes:s.value,vendors:n.value,search:i.value}):l("update:modelValue",null)};a(),(0,t.YP)(s,r(s)),(0,t.YP)(n,r(n)),(0,t.YP)(s,a),(0,t.YP)(n,a),(0,t.YP)(i,a);const d=e=>{"/"===e.key&&"INPUT"!==e.target.tagName&&(e.preventDefault(),document.querySelector(".search-filter input").focus())};return(0,t.bv)((()=>{document.body.addEventListener("keypress",d)})),(0,t.Jd)((()=>{document.removeEventListener("keypress",d)})),{searchPlaceholder:(0,u.iH)("Press / to search"),exposes:O,vendors:N,exposesFilter:s,vendorFilter:n,searchFilter:i}}});const B={name:"SupportedDevices",components:{InfiniteScroll:{name:"InfiniteScroll",props:{debounce:{default:350,type:Number},offset:{default:500,type:Number}},emits:["load"],setup(e,{slots:l,emit:o}){const s=(0,u.iH)(null),n=function(e,l=300){let o,t=!1;return(...s)=>{o?t=!0:(e.apply(this,s),o=setTimeout((()=>{o=void 0,t&&e.apply(this,s),t=!1}),l))}}((()=>{s.value&&s.value.getBoundingClientRect().bottom-window.innerHeight<e.offset&&o("load")}),e.debounce);return(0,t.bv)((()=>{window.addEventListener("scroll",n)})),(0,t.Ah)((()=>{window.removeEventListener("scroll",n)})),()=>(0,t.h)("div",{class:"q-infinite-scroll",ref:s},l.default())}},Filters:(0,I.Z)($,[["render",function(e,l,o,s,n,i){const r=(0,t.up)("multi-select"),a=(0,t.up)("q-icon"),d=(0,t.up)("q-tooltip"),c=(0,t.up)("q-input");return(0,t.wg)(),(0,t.iD)("div",H,[(0,t._)("div",S,[(0,t.Wm)(r,{label:"Vendor",options:e.vendors,modelValue:e.vendorFilter,"onUpdate:modelValue":l[0]||(l[0]=l=>e.vendorFilter=l)},null,8,["options","modelValue"])]),(0,t._)("div",U,[(0,t.Wm)(r,{label:"Exposes",options:e.exposes,modelValue:e.exposesFilter,"onUpdate:modelValue":l[1]||(l[1]=l=>e.exposesFilter=l)},null,8,["options","modelValue"])]),(0,t._)("div",x,[(0,t.Wm)(c,{modelValue:e.searchFilter,"onUpdate:modelValue":l[2]||(l[2]=l=>e.searchFilter=l),filled:"",debounce:500,type:"search",placeholder:e.searchPlaceholder,label:e.searchFilter||"type to search"===e.searchPlaceholder?"Search":"Press / to search",onFocus:l[3]||(l[3]=l=>e.searchPlaceholder="type to search"),onBlur:l[4]||(l[4]=l=>e.searchPlaceholder="Press / to search"),clearable:""},{append:(0,t.w5)((()=>[(0,t.Wm)(a,{name:"info"}),(0,t.Wm)(d,{offset:[0,15],self:"bottom middle"},{default:(0,t.w5)((()=>[F,Z,q])),_:1})])),_:1},8,["modelValue","placeholder","label"])])])}]]),Device:_},setup(){const e=(0,t.f3)(a.ow);(0,t.YP)(e,(e=>d.Z.set(e)),{immediate:!0});const l=(0,u.iH)(null),o=(0,u.iH)(c.Z.getItem("loadIndex")||1),s=(0,u.iH)([]),n=(0,u.iH)([]);return(0,t.YP)(s,(()=>{n.value=s.value.slice(0,20),o.value=1})),(0,t.YP)(o,(e=>{n.value=s.value.slice(0,20*e)})),function(e,l){(0,t.YP)(e,(()=>{if(!e.value)return void(l.value=z);const{exposes:o,vendors:t,search:s}=e.value;let n=!1;if(s)try{n=new RegExp(s,"i")}catch(e){}const i=z.filter((e=>!(o&&!o.every((l=>e.exposes.includes(l)))||t&&!t.includes(e.vendor)||n&&!["model","vendor","description"].some((l=>n.test(e[l]))))));l.value=(e=>e.sort(((e,l)=>{const o=R(e.vendor,l.vendor);return 0===o?R(e.model,l.model):o})))(i)}),{immediate:!0})}(l,s),(0,t.bv)((()=>{const e=c.Z.getItem("zigbee2mqtt-devices-overview")||{};e.loadIndex&&(o.value=e.loadIndex),e.scrollTop&&setTimeout((()=>{window.scrollTo(null,e.scrollTop)}))})),{currentFilters:l,devicesToShow:n,loadItemsByScroll:()=>{20*o.value>=s.value.length||o.value++},storePosition:()=>{c.Z.set("zigbee2mqtt-devices-overview",{loadIndex:o.value,scrollTop:window.scrollY})},onVendorClick:e=>{l.value?l.value.vendors?l.value.vendors.includes(e)||l.value.vendors.push(e):l.value.vendors=[e]:l.value={vendors:[e]}}}}},G=(0,I.Z)(B,[["render",function(e,l,o,a,d,c){const u=(0,t.up)("filters"),v=(0,t.up)("device"),p=(0,t.up)("infinite-scroll");return(0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("div",i,[(0,t.Wm)(u,{modelValue:a.currentFilters,"onUpdate:modelValue":l[0]||(l[0]=e=>a.currentFilters=e)},null,8,["modelValue"])]),(0,t.Wm)(p,{onLoad:a.loadItemsByScroll},{default:(0,t.w5)((()=>[(0,t.Wm)(s.W3,{class:"devices-list",tag:"div",name:"device"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.devicesToShow,(e=>((0,t.wg)(),(0,t.j4)(v,{key:e.vendor+e.model,device:e,onClick:a.storePosition,onVendorClick:a.onVendorClick},null,8,["device","onClick","onVendorClick"])))),128)),0===a.devicesToShow.length?((0,t.wg)(),(0,t.iD)("p",r,"No devices found.")):(0,t.kq)("",!0)])),_:1})])),_:1},8,["onLoad"])])}]]),M=G}}]);